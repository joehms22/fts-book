SQLite Table
============

Introduction
------------
This table is going to use a SQLite database as the backend.

There are a few advantages of using a SQLite database as the backend
over flat files:

*	The database can be opened instantly without being loaded in to
	memory.
*	The need to mark things as "dirty" is less, because deletes will
	cascade throughout the database.
*	Only one file is stored on disk, making it less likely that one of
	them will go missing and become corrupt.

However there are disatvantages as well.

*	SQLite has trouble with huge sets of data.
*	Due to the internal structures, the SQLite data files may be much larger than their flat-file counterparts.


Database Description
--------------------
![A UML diagram of the SQL database layout](https://raw.github.com/joehms22/fts-book/master/Illustrations/sqlite_database.png)

The database is comprised of three main tables `documents`, `terms` and
`metadata_dict`.

The `documents` table, much like that of the documents.json flatfile,
holds the uri of the indexed document, whether or not a newer version
is available in `dirty` and the time the document was indexed in `time`.

The `metadata_dict` table just keeps a record of key->value
relationships for metadata. Keys would be something like `width` and
values would be something like `100`. This, of course, could be
seperated in to an alternate table, with values referencing the key they
belong to, and in turn having a key that would be used to look up
documents with, however this would be a lot of extra code and maintnance.

The `terms` table simply matches a _term_ with a unique id, which can
then be looked up in the `term_document_map` table if you wanted to find
all documents with a given term.

Now we're left with only two helper tables. `metadata_document_map`
maps specific `metadata_dict`s with particular documents, so finding
documents with a particular map should be fast, due to indexing.

The other helper table is `term_doc_location` which matches the
location of a specific term in a certain document, thus if you looked up
all terms for one document, you could "reconstruct" that document.

Software Design
---------------

Fourtinately, Python has built-in support for SQLIte on all of it's
platforms that run the C interpreter. 
